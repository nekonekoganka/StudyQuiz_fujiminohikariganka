<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>çœ¼ç§‘ä¿é™ºç‚¹æ•°ã‚¯ã‚¤ã‚º - çœ¼ç§‘ã‚¹ã‚¿ãƒƒãƒ•å‘ã‘</title>
    <link rel="stylesheet" href="../css/quiz.css">
</head>
<body>
    <div class="quiz-container">
        <h1>ğŸ’° çœ¼ç§‘ä¿é™ºç‚¹æ•°ã‚¯ã‚¤ã‚º ğŸ’°</h1>
        <div class="subtitle">çœ¼ç§‘ã‚¹ã‚¿ãƒƒãƒ•å‘ã‘ - ä¿é™ºç‚¹æ•°ã‚’è¦šãˆã‚ˆã†</div>
        <div id="quizTitleHeader" class="quiz-title-header hidden">ğŸ’° çœ¼ç§‘ä¿é™ºç‚¹æ•°ã‚¯ã‚¤ã‚º</div>

        <div class="top-link"><a href="../index.html">â† ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ã¸</a></div>

        <div id="modeSelection" class="mode-selection">
            <button class="mode-button" onclick="startQuiz('daily')">
                ğŸ“‹ ä»Šæ—¥ã®3å•
            </button>
            <button class="mode-button" onclick="startQuiz('full')">
                ğŸ“š å…¨å•ãƒ¢ãƒ¼ãƒ‰ï¼ˆå…¨16å•ï¼‰
            </button>

            <div id="progressStatus" class="progress-status">
                <div class="progress-status-item">
                    <span>âŒ é–“é•ãˆãŸå•é¡Œ:</span>
                    <span id="incorrectCount">0å•</span>
                </div>
                <div class="progress-status-item">
                    <span>ğŸ†• æœªæŒ‘æˆ¦ã®å•é¡Œ:</span>
                    <span id="unansweredCount">14å•</span>
                </div>
                <div class="progress-status-item">
                    <span>âœ… æ­£è§£ã—ãŸå•é¡Œ:</span>
                    <span id="correctCount">0å•</span>
                </div>
                <div class="progress-status-item">
                    <span>ğŸ“Š å…¨å•é¡Œæ•°:</span>
                    <span id="totalQuestionsCount">14å•</span>
                </div>
            </div>

            <button id="reviewModeButton" class="review-mode-button hidden" onclick="startQuiz('review')">
                âŒ é–“é•ãˆãŸå•é¡Œã ã‘å¾©ç¿’
                <span class="btn-sub">è‹¦æ‰‹ã‚’å…‹æœã—ã‚ˆã†</span>
            </button>

            <div class="mode-description">
                <strong>ä»Šæ—¥ã®3å•:</strong> é–“é•ã„ãƒ»æœªæŒ‘æˆ¦ã‚’å„ªå…ˆå‡ºé¡Œ<br>
                <strong>å…¨å•ãƒ¢ãƒ¼ãƒ‰:</strong> å…¨16å•ã‚’é †ç•ªã«å‡ºé¡Œ<br>
                <span style="color: #6f86d6;">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ã ã„ãŸã„ã®é‡‘é¡æ„Ÿè¦šã‚’èº«ã«ã¤ã‘ã‚ˆã†</span>
            </div>
        </div>

        <div id="quizArea" class="hidden">
            <div class="quiz-status">
                <div class="status-row">
                    <span class="question-progress">å•é¡Œ <span id="currentQ">1</span> / <span id="total">14</span></span>
                    <span class="score-display">æ­£è§£: <span id="score">0</span></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <!-- ========== å•é¡Œ1 ========== -->
            <div class="question-card hidden" id="question1" data-points="291" data-yen="2910">
                <div class="question-number">å•é¡Œ 1</div>
                <div class="question-text">åˆè¨ºæ–™ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(1)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>åˆè¨ºæ–™ã¯291ç‚¹ã€ã¤ã¾ã‚Š2,910å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ2 ========== -->
            <div class="question-card hidden" id="question2" data-points="75" data-yen="750">
                <div class="question-number">å•é¡Œ 2</div>
                <div class="question-text">å†è¨ºæ–™ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(2)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>å†è¨ºæ–™ã¯75ç‚¹ã€ã¤ã¾ã‚Š750å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ3 ========== -->
            <div class="question-card hidden" id="question3" data-points="69" data-yen="690">
                <div class="question-number">å•é¡Œ 3</div>
                <div class="question-text">å±ˆæŠ˜æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(3)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>å±ˆæŠ˜æ¤œæŸ»ã¯69ç‚¹ã€ã¤ã¾ã‚Š690å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ4 ========== -->
            <div class="question-card hidden" id="question4" data-points="84" data-yen="840">
                <div class="question-number">å•é¡Œ 4</div>
                <div class="question-text">è§’è†œæ›²ç‡åŠå¾„è¨ˆæ¸¬ã®æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(4)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>è§’è†œæ›²ç‡åŠå¾„è¨ˆæ¸¬ã¯84ç‚¹ã€ã¤ã¾ã‚Š840å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ5 ========== -->
            <div class="question-card hidden" id="question5" data-points="69" data-yen="690">
                <div class="question-number">å•é¡Œ 5</div>
                <div class="question-text">çŸ¯æ­£è¦–åŠ›æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(5)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>çŸ¯æ­£è¦–åŠ›æ¤œæŸ»ã¯69ç‚¹ã€ã¤ã¾ã‚Š690å††ã§ã™ã€‚å±ˆæŠ˜æ¤œæŸ»ã¨åŒã˜ç‚¹æ•°ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ6 ========== -->
            <div class="question-card hidden" id="question6" data-points="82" data-yen="820">
                <div class="question-number">å•é¡Œ 6</div>
                <div class="question-text">ç²¾å¯†çœ¼åœ§æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(6)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ç²¾å¯†çœ¼åœ§æ¤œæŸ»ã¯82ç‚¹ã€ã¤ã¾ã‚Š820å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ7 ========== -->
            <div class="question-card hidden" id="question7" data-points="112" data-yen="1120">
                <div class="question-number">å•é¡Œ 7</div>
                <div class="question-text">ç²¾å¯†çœ¼åº•æ¤œæŸ»ï¼ˆä¸¡å´ï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(7)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ç²¾å¯†çœ¼åº•æ¤œæŸ»ï¼ˆä¸¡å´ï¼‰ã¯112ç‚¹ã€ã¤ã¾ã‚Š1,120å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ8 ========== -->
            <div class="question-card hidden" id="question8" data-points="110" data-yen="1100">
                <div class="question-number">å•é¡Œ 8</div>
                <div class="question-text">ç´°éš™ç‡ˆé¡•å¾®é¡æ¤œæŸ»ï¼ˆå‰çœ¼éƒ¨åŠã³å¾Œçœ¼éƒ¨ï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(8)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ç´°éš™ç‡ˆé¡•å¾®é¡æ¤œæŸ»ï¼ˆå‰çœ¼éƒ¨åŠã³å¾Œçœ¼éƒ¨ï¼‰ã¯110ç‚¹ã€ã¤ã¾ã‚Š1,100å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ9 ========== -->
            <div class="question-card hidden" id="question9" data-points="48" data-yen="480">
                <div class="question-number">å•é¡Œ 9</div>
                <div class="question-text">ç´°éš™ç‡ˆé¡•å¾®é¡æ¤œæŸ»ï¼ˆå‰çœ¼éƒ¨ï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(9)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ç´°éš™ç‡ˆé¡•å¾®é¡æ¤œæŸ»ï¼ˆå‰çœ¼éƒ¨ï¼‰ã¯48ç‚¹ã€ã¤ã¾ã‚Š480å††ã§ã™ã€‚å¾Œçœ¼éƒ¨ã‚‚è¦‹ã‚‹å ´åˆã¯110ç‚¹ã«ãªã‚Šã¾ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ10 ========== -->
            <div class="question-card hidden" id="question10" data-points="580" data-yen="5800">
                <div class="question-number">å•é¡Œ 10</div>
                <div class="question-text">é™çš„é‡çš„è¦–é‡æ¤œæŸ»ï¼ˆä¸¡çœ¼ï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(10)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>é™çš„é‡çš„è¦–é‡æ¤œæŸ»ã¯ç‰‡çœ¼290ç‚¹ãªã®ã§ã€ä¸¡çœ¼ã§ã¯580ç‚¹ã€ã¤ã¾ã‚Š5,800å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ11 ========== -->
            <div class="question-card hidden" id="question11" data-points="58" data-yen="580">
                <div class="question-number">å•é¡Œ 11</div>
                <div class="question-text">çœ¼åº•ã‚«ãƒ¡ãƒ©æ’®å½±ã®æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(11)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>çœ¼åº•ã‚«ãƒ¡ãƒ©æ’®å½±ã¯58ç‚¹ã€ã¤ã¾ã‚Š580å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ12 ========== -->
            <div class="question-card hidden" id="question12" data-points="190" data-yen="1900">
                <div class="question-number">å•é¡Œ 12</div>
                <div class="question-text">çœ¼åº•ä¸‰æ¬¡å…ƒç”»åƒè§£æï¼ˆOCTï¼‰ã®æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(12)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>çœ¼åº•ä¸‰æ¬¡å…ƒç”»åƒè§£æï¼ˆOCTï¼‰ã¯190ç‚¹ã€ã¤ã¾ã‚Š1,900å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ13 ========== -->
            <div class="question-card hidden" id="question13" data-points="200" data-yen="2000">
                <div class="question-number">å•é¡Œ 13</div>
                <div class="question-text">ã‚³ãƒ³ã‚¿ã‚¯ãƒˆãƒ¬ãƒ³ã‚ºæ¤œæŸ»æ–™1ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(13)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ã‚³ãƒ³ã‚¿ã‚¯ãƒˆãƒ¬ãƒ³ã‚ºæ¤œæŸ»æ–™1ã¯200ç‚¹ã€ã¤ã¾ã‚Š2,000å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ14 ========== -->
            <div class="question-card hidden" id="question14" data-points="70" data-yen="700">
                <div class="question-number">å•é¡Œ 14</div>
                <div class="question-text">èª¿ç¯€æ¤œæŸ»ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(14)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>èª¿ç¯€æ¤œæŸ»ã¯70ç‚¹ã€ã¤ã¾ã‚Š700å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ15 ========== -->
            <div class="question-card hidden" id="question15" data-points="48" data-yen="480">
                <div class="question-number">å•é¡Œ 15</div>
                <div class="question-text">ç”Ÿä½“æŸ“è‰²æ¤œæŸ»ï¼ˆãƒ•ãƒ«ã‚ªï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(15)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>ç”Ÿä½“æŸ“è‰²æ¤œæŸ»ï¼ˆãƒ•ãƒ«ã‚ªï¼‰ã¯48ç‚¹ã€ã¤ã¾ã‚Š480å††ã§ã™ã€‚
                </div>
            </div>

            <!-- ========== å•é¡Œ16 ========== -->
            <div class="question-card hidden" id="question16" data-points="250" data-yen="2500">
                <div class="question-number">å•é¡Œ 16</div>
                <div class="question-text">è¨ºç™‚æƒ…å ±æä¾›æ–™ï¼ˆâ… ï¼‰ã¯ã€ä½•å††ã§ã™ã‹ï¼Ÿ</div>
                <div class="numeric-input-area">
                    <input type="text" inputmode="numeric" class="numeric-input" placeholder="é‡‘é¡" maxlength="6">
                    <span class="numeric-input-unit">å††</span>
                </div>
                <button class="submit-answer-button" onclick="submitNumericAnswer(16)">å›ç­”ã™ã‚‹</button>
                <div class="submit-hint">â€»Â±5%ã®èª¤å·®ã¾ã§æ­£è§£ï¼ˆEnterã‚­ãƒ¼ã§å›ç­”ï¼‰</div>
                <div class="numeric-result hidden"></div>
                <div class="explanation hidden">
                    <strong>è§£èª¬ï¼š</strong>è¨ºç™‚æƒ…å ±æä¾›æ–™ï¼ˆâ… ï¼‰ã¯250ç‚¹ã€ã¤ã¾ã‚Š2,500å††ã§ã™ã€‚
                </div>
            </div>

            <div class="buttons">
                <button class="next-button hidden" onclick="nextQuestion()">æ¬¡ã®å•é¡Œã¸</button>
                <button class="result-button hidden" onclick="showFinalScore()">ğŸŠ çµæœç™ºè¡¨ã¸ ğŸŠ</button>
            </div>
        </div>
    </div>

    <script src="quiz-config.js"></script>
    <script>
        // ============================================================
        // ã‚¯ã‚¤ã‚ºå›ºæœ‰ã®è¨­å®š
        // ============================================================
        const QUIZ_ID = 'hoken-tensuu';
        const TOTAL_QUESTIONS = 16;

        // ============================================================
        // ä»¥ä¸‹ã¯å¤‰æ›´ä¸è¦ï¼ˆå…±é€šå‡¦ç†ï¼‰
        // ============================================================

        // å…¨ã‚¯ã‚¤ã‚ºä¸€è¦§ï¼ˆã‚·ãƒ£ãƒƒãƒ•ãƒ«æ©Ÿèƒ½ç”¨ï¼‰
        const ALL_QUIZZES = [
            'ã‚³ãƒ³ã‚¿ã‚¯ãƒˆå‡¦æ–¹ã®åŸºæœ¬ã‚¯ã‚¤ã‚º.html',
            'å¤§äººã®é ãç”¨ãƒ¡ã‚¬ãƒåˆã‚ã›ã‚¯ã‚¤ã‚º.html',
            'å¼±è¦–ã‚¯ã‚¤ã‚º.html',
            'æ–œè¦–ã‚¯ã‚¤ã‚º.html',
            'ç™½å†…éšœã«ã¤ã„ã¦ã‚¯ã‚¤ã‚º.html',
            'ç·‘å†…éšœã«ã¤ã„ã¦ã‚¯ã‚¤ã‚º.html',
            'è€çœ¼é¡åˆã‚ã›_ã‚¯ã‚¤ã‚º.html',
            'è‡ªæ²»ä½“ã®ç·‘å†…éšœæ¤œè¨ºã®åˆ¶åº¦ã®ã‚¯ã‚¤ã‚º.html',
            'èŠ±ç²‰ç—‡ã«ã¤ã„ã¦ã®ã‚¯ã‚¤ã‚º.html',
            'è¿‘è¦–ã«ã¤ã„ã¦ã®ã‚¯ã‚¤ã‚º.html',
            'é™¢å†…ãƒ«ãƒ¼ãƒ«ç¢ºèªã‚¯ã‚¤ã‚º.html',
            'å°å…è¿‘è¦–å¯¾ç­–_ã‚¯ã‚¤ã‚º.html',
            'CLåˆä½µç—‡_ã‚¯ã‚¤ã‚º.html',
            'ç³–å°¿ç—…ç¶²è†œç—‡_ã‚¯ã‚¤ã‚º.html',
            'æµæ¶™ç—‡_ã‚¯ã‚¤ã‚º.html',
            'é»„æ–‘å‰è†œ_ã‚¯ã‚¤ã‚º.html',
            'ã‚¢ãƒˆãƒ”ãƒ¼æ€§çš®è†šç‚ã¨ç›®_ã‚¯ã‚¤ã‚º.html',
            'ã¶ã©ã†è†œç‚_ã‚¯ã‚¤ã‚º.html',
            'é£›èšŠç—‡_ã‚¯ã‚¤ã‚º.html',
            'çœ¼ç§‘ä¿é™ºè¨ºç™‚_ã‚¯ã‚¤ã‚º.html',
            'çœ¼ç§‘ä¿é™ºç‚¹æ•°_ã‚¯ã‚¤ã‚º.html'
        ];
        const CURRENT_QUIZ_FILE = decodeURIComponent(location.pathname.split('/').pop());

        let currentQuestion = 1;
        let score = 0;
        let totalQuestions = TOTAL_QUESTIONS;
        let questionList = [];
        let isDaily = false;

        // å•é¡Œç•ªå·ã®é…åˆ—ã‚’ç”Ÿæˆ
        const allQuestions = Array.from({length: TOTAL_QUESTIONS}, (_, i) => i + 1);

        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ¢ãƒ¼ãƒ‰ãƒœã‚¿ãƒ³ã®çŠ¶æ…‹ã‚’æ›´æ–°
        document.addEventListener('DOMContentLoaded', function() {
            updateProgressStatus();

            // URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’ãƒã‚§ãƒƒã‚¯
            const urlParams = new URLSearchParams(window.location.search);
            const mode = urlParams.get('mode');

            // ä»Šæ—¥ã®â—‹å•ãƒœã‚¿ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã‚’æ›´æ–°
            const dailyCount = getDailyQuestionCount();
            const dailyBtn = document.querySelector('.mode-button');
            if (dailyBtn && dailyBtn.textContent.includes('ä»Šæ—¥ã®')) {
                dailyBtn.textContent = `ğŸ“‹ ä»Šæ—¥ã®${dailyCount}å•`;
            }

            // Enterã‚­ãƒ¼ã§ã®å›ç­”ã‚’ã‚µãƒãƒ¼ãƒˆ
            document.querySelectorAll('.numeric-input').forEach(input => {
                input.addEventListener('keypress', function(e) {
                    if (e.key === 'Enter') {
                        const questionCard = this.closest('.question-card');
                        const questionId = parseInt(questionCard.id.replace('question', ''));
                        submitNumericAnswer(questionId);
                    }
                });
                // æ•°å­—ã®ã¿å…¥åŠ›ã‚’è¨±å¯
                input.addEventListener('input', function(e) {
                    this.value = this.value.replace(/[^0-9]/g, '');
                });
            });

            // ãƒ¢ãƒ¼ãƒ‰ãŒæŒ‡å®šã•ã‚Œã¦ã„ãŸã‚‰è‡ªå‹•é–‹å§‹
            if (mode && (mode.startsWith('daily') || mode === 'full' || mode === 'review')) {
                startQuiz(mode);
            }
        });

        // å­¦ç¿’çŠ¶æ³ã®è¡¨ç¤ºã‚’æ›´æ–°
        function updateProgressStatus() {
            const incorrectList = getIncorrectQuestions(QUIZ_ID);
            const unansweredList = getUnansweredQuestions(QUIZ_ID, TOTAL_QUESTIONS);
            const correctNum = TOTAL_QUESTIONS - incorrectList.length - unansweredList.length;

            const incorrectCount = document.getElementById('incorrectCount');
            const unansweredCount = document.getElementById('unansweredCount');
            const correctCount = document.getElementById('correctCount');
            const totalQuestionsCount = document.getElementById('totalQuestionsCount');

            if (incorrectCount) {
                incorrectCount.textContent = `${incorrectList.length}å•`;
            }
            if (unansweredCount) {
                unansweredCount.textContent = `${unansweredList.length}å•`;
            }
            if (correctCount) {
                correctCount.textContent = `${correctNum}å•`;
            }
            if (totalQuestionsCount) {
                totalQuestionsCount.textContent = `${TOTAL_QUESTIONS}å•`;
            }

            // é–“é•ãˆãŸå•é¡Œå¾©ç¿’ãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            const reviewModeBtn = document.getElementById('reviewModeButton');
            if (reviewModeBtn) {
                if (incorrectList.length > 0) {
                    reviewModeBtn.classList.remove('hidden');
                    reviewModeBtn.innerHTML = `âŒ é–“é•ãˆãŸå•é¡Œã ã‘å¾©ç¿’<span class="btn-sub">${incorrectList.length}å•</span>`;
                } else {
                    reviewModeBtn.classList.add('hidden');
                }
            }
        }

        // æ­£è§£æ™‚ãƒ•ãƒ©ãƒƒã‚·ãƒ¥åŠ¹æœ
        function flashCorrect(element) {
            const card = element.closest('.question-card');
            if (card) {
                card.classList.add('correct-flash');
                setTimeout(() => card.classList.remove('correct-flash'), 400);
            }
        }

        // çµæœç™ºè¡¨ã‚¨ãƒ•ã‚§ã‚¯ãƒˆ
        function celebrateResult(isPerfect) {
            if (navigator.vibrate) {
                if (isPerfect) {
                    navigator.vibrate([100, 50, 100, 50, 100]);
                } else {
                    navigator.vibrate([50, 30, 50]);
                }
            }

            const emojis = isPerfect
                ? ['ğŸ‰', 'ğŸ†', 'ğŸ‘‘', 'ğŸ’¯', 'â­', 'âœ¨', 'ğŸŒŸ', 'ğŸ¥‡']
                : ['ğŸ‰', 'â­', 'âœ¨', 'ğŸ‘', 'ğŸŠ'];
            const count = isPerfect ? 15 : 8;
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 3;

            for (let i = 0; i < count; i++) {
                setTimeout(() => {
                    const emoji = document.createElement('div');
                    emoji.className = 'celebrate-emoji';
                    emoji.textContent = emojis[Math.floor(Math.random() * emojis.length)];
                    emoji.style.left = (centerX - 100 + Math.random() * 200) + 'px';
                    emoji.style.top = (centerY + Math.random() * 50) + 'px';
                    document.body.appendChild(emoji);

                    setTimeout(() => emoji.remove(), 1000);
                }, i * 100);
            }
        }

        function startQuiz(mode) {
            document.querySelector('h1').classList.add('hidden');
            document.querySelector('.subtitle').classList.add('hidden');
            document.getElementById('modeSelection').classList.add('hidden');
            document.getElementById('quizArea').classList.remove('hidden');
            document.getElementById('quizTitleHeader').classList.remove('hidden');

            if (mode === 'review') {
                // é–“é•ãˆãŸå•é¡Œã®ã¿ã‚’å‡ºé¡Œ
                isDaily = false;
                questionList = getIncorrectQuestions(QUIZ_ID);
                if (questionList.length === 0) {
                    // é–“é•ãˆãŸå•é¡ŒãŒãªã„å ´åˆã¯ãƒ‡ã‚¤ãƒªãƒ¼ãƒ¢ãƒ¼ãƒ‰ã«æˆ»ã™
                    questionList = getWeightedRandomQuestions(QUIZ_ID, TOTAL_QUESTIONS, getDailyQuestionCount());
                }
                totalQuestions = questionList.length;
            } else if (mode.startsWith('daily')) {
                isDaily = true;
                const countFromUrl = parseInt(mode.replace('daily', ''));
                totalQuestions = countFromUrl || getDailyQuestionCount();
                questionList = getWeightedRandomQuestions(QUIZ_ID, TOTAL_QUESTIONS, totalQuestions);
            } else {
                isDaily = false;
                totalQuestions = TOTAL_QUESTIONS;
                questionList = [...allQuestions];
            }

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const questionElement = document.getElementById(`question${i}`);
                if(questionElement) {
                    if (questionList.includes(i)) {
                        if (i === questionList[0]) {
                            questionElement.classList.remove('hidden');
                        } else {
                            questionElement.classList.add('hidden');
                        }
                    } else {
                        questionElement.style.display = 'none';
                    }
                }
            }

            currentQuestion = 0;
            updateQuestionNumbers();
            document.getElementById('total').textContent = totalQuestions;
            updateProgress();
        }

        function updateQuestionNumbers() {
            questionList.forEach((questionId, index) => {
                const questionElement = document.getElementById(`question${questionId}`);
                if(questionElement) {
                    const questionNumber = questionElement.querySelector('.question-number');
                    questionNumber.textContent = `å•é¡Œ ${index + 1}`;
                }
            });
        }

        function updateProgress() {
            const progress = ((currentQuestion + 1) / totalQuestions) * 100;
            document.getElementById('progressBar').style.width = progress + '%';
            document.getElementById('currentQ').textContent = currentQuestion + 1;
        }

        // æ•°å€¤å…¥åŠ›ã®å›ç­”å‡¦ç†ï¼ˆÂ±5%è¨±å®¹ï¼‰
        function submitNumericAnswer(questionId) {
            const questionElement = document.getElementById(`question${questionId}`);
            const input = questionElement.querySelector('.numeric-input');
            const submitBtn = questionElement.querySelector('.submit-answer-button');
            const submitHint = questionElement.querySelector('.submit-hint');
            const resultArea = questionElement.querySelector('.numeric-result');
            const explanation = questionElement.querySelector('.explanation');
            const nextButton = document.querySelector('.next-button');
            const resultButton = document.querySelector('.result-button');

            // å…¥åŠ›å€¤ã‚’å–å¾—
            const userAnswer = parseInt(input.value) || 0;
            const correctYen = parseInt(questionElement.dataset.yen);
            const points = parseInt(questionElement.dataset.points);

            // å…¥åŠ›ã‚’ç„¡åŠ¹åŒ–
            input.disabled = true;
            submitBtn.disabled = true;

            // ãƒ’ãƒ³ãƒˆã‚’éè¡¨ç¤ºï¼ˆã‚¹ãƒãƒ›ç”»é¢ã‚¹ãƒšãƒ¼ã‚¹ç¢ºä¿ï¼‰
            if (submitHint) {
                submitHint.style.display = 'none';
            }

            // Â±5%ã®è¨±å®¹ç¯„å›²ã‚’è¨ˆç®—
            const tolerance = correctYen * 0.05;
            const minAccept = correctYen - tolerance;
            const maxAccept = correctYen + tolerance;

            const isPerfect = userAnswer === correctYen;
            const isWithinRange = userAnswer >= minAccept && userAnswer <= maxAccept;
            const isCorrect = isPerfect || isWithinRange;

            // çµæœè¡¨ç¤ºã‚’ä½œæˆ
            let resultHTML = '';
            if (isPerfect) {
                // å®Œå…¨ä¸€è‡´ï¼šç‰¹åˆ¥ã«è¤’ã‚ã‚‹
                resultHTML = `
                    <div class="numeric-result-icon">ğŸ¯</div>
                    <div class="numeric-result-text">å®Œç’§ï¼ãƒ”ãƒƒã‚¿ãƒªæ­£è§£ï¼</div>
                    <div class="answer-breakdown">
                        <span class="points">${points}ç‚¹</span> = <span class="yen">${correctYen.toLocaleString()}å††</span>
                    </div>
                `;
                resultArea.className = 'numeric-result correct perfect';
                score++;
                flashCorrect(input);
            } else if (isWithinRange) {
                // Â±5%ä»¥å†…ï¼šæ­£è§£
                resultHTML = `
                    <div class="numeric-result-icon">â­•</div>
                    <div class="numeric-result-text">ã ã„ãŸã„åˆã£ã¦ã‚‹ï¼</div>
                    <div class="numeric-result-detail">
                        ã‚ãªãŸã®å›ç­”: ${userAnswer.toLocaleString()}å††
                    </div>
                    <div class="answer-breakdown">
                        æ­£è§£: <span class="points">${points}ç‚¹</span> = <span class="yen">${correctYen.toLocaleString()}å††</span>
                    </div>
                `;
                resultArea.className = 'numeric-result correct';
                score++;
                flashCorrect(input);
            } else {
                // ä¸æ­£è§£
                resultHTML = `
                    <div class="numeric-result-icon">âŒ</div>
                    <div class="numeric-result-text">ä¸æ­£è§£</div>
                    <div class="numeric-result-detail">
                        ã‚ãªãŸã®å›ç­”: <span class="user-answer">${userAnswer.toLocaleString()}å††</span>
                    </div>
                    <div class="answer-breakdown">
                        æ­£è§£: <span class="points">${points}ç‚¹</span> = <span class="yen">${correctYen.toLocaleString()}å††</span>
                    </div>
                `;
                resultArea.className = 'numeric-result incorrect';
            }

            resultArea.innerHTML = resultHTML;
            resultArea.classList.remove('hidden');

            // çµæœã‚’è¨˜éŒ²
            if (typeof recordQuestionResult === 'function') {
                recordQuestionResult(QUIZ_ID, questionId, isCorrect);
            }

            explanation.classList.remove('hidden');

            if (currentQuestion < totalQuestions - 1) {
                nextButton.classList.remove('hidden');
            } else {
                resultButton.classList.remove('hidden');
            }

            updateScore();
            resultArea.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

        function nextQuestion() {
            const currentQuestionId = questionList[currentQuestion];
            document.getElementById(`question${currentQuestionId}`).classList.add('hidden');

            currentQuestion++;
            const nextQuestionId = questionList[currentQuestion];

            document.getElementById(`question${nextQuestionId}`).classList.remove('hidden');
            document.querySelector('.next-button').classList.add('hidden');
            updateProgress();

            // æ¬¡ã®å•é¡Œã®å…¥åŠ›æ¬„ã«ãƒ•ã‚©ãƒ¼ã‚«ã‚¹
            const nextInput = document.getElementById(`question${nextQuestionId}`).querySelector('.numeric-input');
            if (nextInput) {
                setTimeout(() => nextInput.focus(), 100);
            }
        }

        function showFinalScore() {
            questionList.forEach(questionId => {
                const qElem = document.getElementById(`question${questionId}`);
                if(qElem) qElem.classList.add('hidden');
            });
            document.querySelector('.next-button').classList.add('hidden');
            document.querySelector('.result-button').classList.add('hidden');
            document.querySelector('.quiz-status').classList.add('hidden');
            document.getElementById('quizArea').classList.add('hidden');
            document.querySelector('.quiz-container').classList.add('hidden');

            const percentage = Math.round((score / totalQuestions) * 100);
            const isPerfect = score === totalQuestions;
            setTimeout(() => {
                celebrateResult(isPerfect);
            }, 300);

            // çµæœã‚’è¨˜éŒ²ï¼ˆã‚¨ãƒ©ãƒ¼ã§ã‚‚çµæœç”»é¢ã¯è¡¨ç¤ºã™ã‚‹ï¼‰
            let newBadges = [];
            try {
                if (typeof recordQuizResult === 'function') {
                    const result = recordQuizResult(QUIZ_ID, score, totalQuestions);
                    if (result && result._newBadges) {
                        newBadges = result._newBadges;
                    }
                }
            } catch (e) {
                console.error('çµæœè¨˜éŒ²ä¸­ã«ã‚¨ãƒ©ãƒ¼:', e);
            }

            let title, message;

            if (score === totalQuestions) {
                title = 'ğŸ† å®Œç’§ã§ã™ï¼ ğŸ†';
                message = `å…¨å•æ­£è§£ï¼ç´ æ™´ã‚‰ã—ã„çŸ¥è­˜ã§ã™ã€‚\nä¿é™ºç‚¹æ•°ã‚’ã—ã£ã‹ã‚Šè¦šãˆã¦ã„ã¾ã™ã­ã€‚`;
            } else if (score >= totalQuestions * 0.8) {
                title = 'ğŸŒŸ ç´ æ™´ã‚‰ã—ã„ï¼ ğŸŒŸ';
                message = `é«˜å¾—ç‚¹ã§ã™ï¼ä¿é™ºç‚¹æ•°ã®é‡è¦é …ç›®ã‚’ã—ã£ã‹ã‚Šè¦šãˆã¦ã„ã¾ã™ã€‚\né–“é•ãˆãŸç‚¹æ•°ã‚’å¾©ç¿’ã™ã‚Œã°å®Œç’§ã§ã™ã‚ˆã€‚`;
            } else if (score >= totalQuestions * 0.5) {
                title = 'ğŸ‘ ã‚ˆãã§ãã¾ã—ãŸï¼ ğŸ‘';
                message = `åŸºæœ¬çš„ãªç‚¹æ•°ã¯è¦šãˆã¦ã„ã¾ã™ã­ã€‚\nè§£èª¬ã‚’èª­ã¿ç›´ã—ã¦ã€çŸ¥è­˜ã‚’å›ºã‚ã¾ã—ã‚‡ã†ã€‚`;
            } else {
                title = 'ğŸ’ª ã“ã‚Œã‹ã‚‰ãŒæœ¬ç•ªï¼ ğŸ’ª';
                message = `è‰¯ã„å¾©ç¿’ã®æ©Ÿä¼šã«ãªã‚Šã¾ã—ãŸã­ã€‚\nä¿é™ºç‚¹æ•°ã‚’è¦šãˆã¦ã€æ—¥ã€…ã®æ¥­å‹™ã«æ´»ã‹ã—ã¦ã„ãã¾ã—ã‚‡ã†ï¼`;
            }

            const resultTitleHTML = `<div class="result-title">ğŸŠ çµæœç™ºè¡¨ ğŸŠ</div>`;
            const scoreHTML = `<span class="final-score-highlight">æœ€çµ‚ã‚¹ã‚³ã‚¢ : ${score}/${totalQuestions}ï¼ˆ${percentage}%ï¼‰</span>`;
            const evaluationHTML = `<div class="result-evaluation">${title}</div>`;
            const messageHTML = `<div>${message.replace(/\n/g, '<br>')}</div>`;

            // é€²æ—æƒ…å ±ã‚’å–å¾—ã—ã¦è¡¨ç¤ºï¼ˆã‚¨ãƒ©ãƒ¼æ™‚ã¯ç©ºæ–‡å­—ï¼‰
            let progressHTML = '';
            try {
                progressHTML = generateResultProgressHTML();
            } catch (e) {
                console.error('é€²æ—HTMLç”Ÿæˆã‚¨ãƒ©ãƒ¼:', e);
            }

            document.getElementById('resultDetail').innerHTML = resultTitleHTML + evaluationHTML + scoreHTML + messageHTML + progressHTML;

            // ãƒãƒƒã‚¸ç²å¾—è¡¨ç¤º
            try {
                const badgeArea = document.getElementById('badgeAchievement');
                if (badgeArea && newBadges.length > 0 && typeof renderBadgeAchievement === 'function') {
                    badgeArea.innerHTML = renderBadgeAchievement(newBadges);
                } else if (badgeArea) {
                    badgeArea.innerHTML = '';
                }
            } catch (e) {
                console.error('ãƒãƒƒã‚¸è¡¨ç¤ºã‚¨ãƒ©ãƒ¼:', e);
            }

            document.getElementById('finalResult').classList.remove('hidden');
            document.querySelector('.shuffle-button').classList.remove('hidden');
            const dailyCount = getDailyQuestionCount();
            document.getElementById('shuffleButton').innerHTML = 'ğŸ² ã‚·ãƒ£ãƒƒãƒ•ãƒ«' + dailyCount + 'å•<span class="btn-sub">åˆ¥ã‚¸ãƒ£ãƒ³ãƒ«</span>';
            document.getElementById('retryButton').innerHTML = 'ğŸ”„ ã‚‚ã†' + dailyCount + 'å•<span class="btn-sub">åŒã‚¸ãƒ£ãƒ³ãƒ«</span>';
            document.querySelector('.retry-button').classList.remove('hidden');
            document.querySelector('.record-button').classList.remove('hidden');
            document.querySelector('.home-button-small').classList.remove('hidden');
            document.querySelector('.top-link').classList.add('hidden');

            // é–“é•ãˆãŸå•é¡Œãƒœã‚¿ãƒ³ã®è¡¨ç¤ºåˆ¶å¾¡
            const incorrectList = getIncorrectQuestions(QUIZ_ID);
            const reviewBtn = document.getElementById('reviewIncorrectButton');
            if (reviewBtn) {
                if (incorrectList.length > 0) {
                    reviewBtn.classList.remove('hidden');
                    reviewBtn.innerHTML = `âŒ é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’<span class="btn-sub">${incorrectList.length}å•</span>`;
                } else {
                    reviewBtn.classList.add('hidden');
                }
            }

            // ãƒˆãƒƒãƒ—ã¸ã‚¹ã‚¯ãƒ­ãƒ¼ãƒ«
            arrangeResultCards();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        function resetQuiz() {
            document.getElementById('finalResult').classList.add('hidden');
            document.querySelector('.quiz-container').classList.remove('hidden');
            document.querySelector('.top-link').classList.remove('hidden');
            score = 0;
            updateScore();

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const questionElement = document.getElementById(`question${i}`);
                if(questionElement){
                    questionElement.style.display = '';
                    questionElement.classList.add('hidden');

                    // æ•°å€¤å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ
                    const input = questionElement.querySelector('.numeric-input');
                    if (input) {
                        input.value = '';
                        input.disabled = false;
                    }
                    const submitBtn = questionElement.querySelector('.submit-answer-button');
                    if (submitBtn) {
                        submitBtn.disabled = false;
                    }
                    const resultArea = questionElement.querySelector('.numeric-result');
                    if (resultArea) {
                        resultArea.classList.add('hidden');
                        resultArea.innerHTML = '';
                    }

                    questionElement.querySelector('.explanation').classList.add('hidden');
                }
            }

            document.querySelector('.next-button').classList.add('hidden');
            document.querySelector('.result-button').classList.add('hidden');
            document.querySelector('.shuffle-button').classList.add('hidden');
            document.querySelector('.retry-button').classList.add('hidden');
            document.querySelector('.record-button').classList.add('hidden');
            document.querySelector('.home-button-small').classList.add('hidden');

            document.querySelector('.quiz-status').classList.remove('hidden');

            if (isDaily) {
                startQuiz('daily');
            } else {
                startQuiz('full');
            }
        }

        function goHome() {
            document.getElementById('finalResult').classList.add('hidden');
            document.getElementById('quizArea').classList.add('hidden');
            document.querySelector('.quiz-container').classList.remove('hidden');
            document.querySelector('.top-link').classList.remove('hidden');

            document.querySelector('h1').classList.remove('hidden');
            document.querySelector('.subtitle').classList.remove('hidden');
            document.getElementById('quizTitleHeader').classList.add('hidden');

            for (let i = 1; i <= TOTAL_QUESTIONS; i++) {
                const questionElement = document.getElementById(`question${i}`);
                if(questionElement) {
                    questionElement.style.display = '';
                    questionElement.classList.add('hidden');

                    // æ•°å€¤å…¥åŠ›ã‚’ãƒªã‚»ãƒƒãƒˆ
                    const input = questionElement.querySelector('.numeric-input');
                    if (input) {
                        input.value = '';
                        input.disabled = false;
                    }
                    const submitBtn = questionElement.querySelector('.submit-answer-button');
                    if (submitBtn) {
                        submitBtn.disabled = false;
                    }
                    const resultArea = questionElement.querySelector('.numeric-result');
                    if (resultArea) {
                        resultArea.classList.add('hidden');
                        resultArea.innerHTML = '';
                    }

                    questionElement.querySelector('.explanation').classList.add('hidden');
                }
            }

            document.querySelector('.next-button').classList.add('hidden');
            document.querySelector('.result-button').classList.add('hidden');
            document.querySelector('.shuffle-button').classList.add('hidden');
            document.querySelector('.retry-button').classList.add('hidden');
            document.querySelector('.record-button').classList.add('hidden');
            document.querySelector('.home-button-small').classList.add('hidden');
            document.querySelector('.quiz-status').classList.remove('hidden');

            currentQuestion = 1;
            score = 0;
            totalQuestions = TOTAL_QUESTIONS;
            questionList = [];
            isDaily = false;

            updateScore();
            updateProgressStatus();

            document.getElementById('modeSelection').classList.remove('hidden');
        }

        function updateScore() {
            document.getElementById('score').textContent = score;
        }

        // ãƒªã‚¶ãƒ«ãƒˆç”»é¢ç”¨ã®é€²æ—HTMLç”Ÿæˆ
        function generateResultProgressHTML() {
            const incorrectList = getIncorrectQuestions(QUIZ_ID);
            const unansweredList = getUnansweredQuestions(QUIZ_ID, TOTAL_QUESTIONS);
            const correctNum = TOTAL_QUESTIONS - incorrectList.length - unansweredList.length;
            const progressPercent = Math.round((correctNum / TOTAL_QUESTIONS) * 100);
            const isPerfect = correctNum === TOTAL_QUESTIONS;

            return `
                <div class="result-progress-section">
                    <div class="result-progress-title">ğŸ“Š ã“ã®ã‚¯ã‚¤ã‚ºã®é€²æ—</div>
                    <div class="result-progress-bar-container">
                        <div class="result-progress-bar-fill ${isPerfect ? 'perfect' : ''}" style="width: ${progressPercent}%"></div>
                    </div>
                    <div class="result-progress-percentage">${isPerfect ? 'ğŸŒ¸ ' : ''}${progressPercent}%${isPerfect ? ' ãƒã‚¹ã‚¿ãƒ¼ï¼' : ''}</div>
                    <div class="result-progress-stats">
                        <div class="result-progress-stat">
                            <span>âœ… æ­£è§£</span>
                            <span>${correctNum}å•</span>
                        </div>
                        <div class="result-progress-stat">
                            <span>âŒ é–“é•ã„</span>
                            <span>${incorrectList.length}å•</span>
                        </div>
                        <div class="result-progress-stat">
                            <span>ğŸ†• æœªæŒ‘æˆ¦</span>
                            <span>${unansweredList.length}å•</span>
                        </div>
                        <div class="result-progress-stat">
                            <span>ğŸ“ å…¨å•é¡Œ</span>
                            <span>${TOTAL_QUESTIONS}å•</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function goToRandomQuiz() {
            // é‡ã¿ä»˜ã‘ã§ã‚¯ã‚¤ã‚ºã‚’é¸æŠï¼ˆæœªæŒ‘æˆ¦ãƒ»é–“é•ã„ãŒå¤šã„ã‚¯ã‚¤ã‚ºã‚’å„ªå…ˆï¼‰
            const selectedQuiz = getWeightedRandomQuiz(CURRENT_QUIZ_FILE);
            if (!selectedQuiz) {
                // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯: å¾“æ¥ã®ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ
                const otherQuizzes = ALL_QUIZZES.filter(q => q !== CURRENT_QUIZ_FILE);
                const randomQuiz = otherQuizzes[Math.floor(Math.random() * otherQuizzes.length)];
                const dailyCount = getDailyQuestionCount();
                window.location.href = encodeURI(randomQuiz) + `?mode=daily${dailyCount}`;
                return;
            }
            const dailyCount = getDailyQuestionCount();
            window.location.href = encodeURI(selectedQuiz) + `?mode=daily${dailyCount}`;
        }

        function restartThisQuiz() {
            const dailyCount = getDailyQuestionCount();
            window.location.href = encodeURI(CURRENT_QUIZ_FILE) + `?mode=daily`;
        }

        // é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’
        function reviewIncorrectQuestions() {
            const incorrectList = getIncorrectQuestions(QUIZ_ID);
            if (incorrectList.length === 0) return;

            // é–“é•ãˆãŸå•é¡Œæ•°ã‚’URLãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã¨ã—ã¦æ¸¡ã™
            window.location.href = encodeURI(CURRENT_QUIZ_FILE) + `?mode=review`;
        }
    </script>

    <div id="finalResult" class="final-score-card hidden">
      <div id="resultDetail" class="result-detail"></div>
      <div id="badgeAchievement"></div>
      <div class="result-buttons">
        <div class="result-buttons-row">
          <button id="shuffleButton" class="shuffle-button hidden" onclick="goToRandomQuiz()">
            ğŸ² åˆ¥ã®ã‚¯ã‚¤ã‚ºã¸
            <span class="btn-sub">ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ</span>
          </button>
          <button id="retryButton" class="retry-button hidden" onclick="restartThisQuiz()">
            ğŸ”„ ã‚‚ã†ä¸€åº¦
            <span class="btn-sub">åŒã˜ã‚¯ã‚¤ã‚º</span>
          </button>
        </div>
        <div class="result-buttons-row" style="margin-bottom: 12px;">
          <button id="reviewIncorrectButton" class="review-incorrect-button hidden" onclick="reviewIncorrectQuestions()">
            âŒ é–“é•ãˆãŸå•é¡Œã‚’å¾©ç¿’
            <span class="btn-sub">è‹¦æ‰‹ã‚’å…‹æœ</span>
          </button>
        </div>
        <div class="result-buttons-row secondary">
          <a href="../mypage.html" class="record-button hidden">ğŸ“Š å­¦ç¿’è¨˜éŒ²</a>
          <a href="../index.html" class="home-button-small hidden">ğŸ  ãƒ›ãƒ¼ãƒ </a>
        </div>
      </div>
    </div>

</body>
</html>
