<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>糖尿病網膜症クイズ - 眼科スタッフ向け</title>
    <link rel="stylesheet" href="../css/quiz.css">
</head>
<body>
    <div class="quiz-container">
        <h1>🩺 糖尿病網膜症クイズ 🩺</h1>
        <div class="subtitle">眼科スタッフ向け - 糖尿病網膜症の理解を深めよう</div>
        <div id="quizTitleHeader" class="quiz-title-header hidden">🩺 糖尿病網膜症クイズ</div>

        <div class="top-link">
            <a href="../index.html" class="home-link">🏠 ホームへ</a>
            <button id="prevButton" class="prev-button hidden" onclick="prevQuestion()">← 前の問題へ</button>
        </div>

        <div id="modeSelection" class="mode-selection">
            <button class="mode-button" onclick="startQuiz('daily')">
                📋 今日の3問
            </button>
            <button class="mode-button" onclick="startQuiz('full')">
                📚 全問モード（全10問）
            </button>

            <div id="progressStatus" class="progress-status">
                <div class="progress-status-item">
                    <span>❌ 間違えた問題:</span>
                    <span id="incorrectCount">0問</span>
                </div>
                <div class="progress-status-item">
                    <span>🆕 未挑戦の問題:</span>
                    <span id="unansweredCount">10問</span>
                </div>
                <div class="progress-status-item">
                    <span>✅ 正解した問題:</span>
                    <span id="correctCount">0問</span>
                </div>
                <div class="progress-status-item">
                    <span>📊 全問題数:</span>
                    <span id="totalQuestionsCount">10問</span>
                </div>
            </div>

            <button id="reviewModeButton" class="review-mode-button hidden" onclick="startQuiz('review')">
                ❌ 間違えた問題だけ復習
                <span class="btn-sub">苦手を克服しよう</span>
            </button>

            <div class="mode-description">
                <strong>今日の3問:</strong> 間違い・未挑戦を優先出題<br>
                <strong>全問モード:</strong> 全10問を順番に出題
            </div>
        </div>

        <div id="quizArea" class="hidden">
            <div class="quiz-status">
                <div class="status-row">
                    <span class="question-progress">問題 <span id="currentQ">1</span> / <span id="total">10</span></span>
                    <span class="score-display">正解: <span id="score">0</span></span>
                </div>
                <div class="progress-bar">
                    <div class="progress-fill" id="progressBar"></div>
                </div>
            </div>

            <!-- ========== 問題1 ========== -->
            <div class="question-card hidden" id="question1">
                <div class="question-number">問題 1</div>
                <div class="question-text">糖尿病で視力が低下する仕組みとして正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">眼球の透明な組織の混濁と、網膜の機能が失われること</div>
                    <div class="option" data-answer="false">眼圧の上昇のみ</div>
                    <div class="option" data-answer="false">角膜の屈折異常のみ</div>
                    <div class="option" data-answer="false">視神経の圧迫のみ</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>糖尿病で視力が低下する仕組みは2つあります。1つは眼球の透明な組織が混濁すること（白内障、水泡性角膜症、硝子体出血など）、もう1つは光を感じる神経である網膜の機能が失われることです。
                </div>
            </div>

            <!-- ========== 問題2 ========== -->
            <div class="question-card hidden" id="question2">
                <div class="question-number">問題 2</div>
                <div class="question-text">糖尿病網膜症における2大失明原因として正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">牽引性網膜剥離と血管新生緑内障</div>
                    <div class="option" data-answer="false">白内障と角膜混濁</div>
                    <div class="option" data-answer="false">硝子体出血と黄斑浮腫</div>
                    <div class="option" data-answer="false">ドライアイと結膜炎</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>糖尿病による直接的な2大失明原因は、牽引性網膜剥離と血管新生緑内障です。どちらも糖尿病によって網膜の血管が損傷される糖尿病網膜症によって引き起こされます。
                    <div class="explanation-image">
                        <img src="../images/explanation/眼底/糖尿病網膜症の眼底写真.png" alt="糖尿病網膜症の眼底写真">
                        <span class="image-caption">糖尿病網膜症の眼底写真：新生血管と網膜前出血が見られる</span>
                    </div>
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>糖尿病網膜症は放置すると失明に至る可能性があることを説明し、定期的な眼底検査の重要性を伝えましょう。
                    </div>
                </div>
            </div>

            <!-- ========== 問題3 ========== -->
            <div class="question-card hidden" id="question3">
                <div class="question-number">問題 3</div>
                <div class="question-text">糖尿病黄斑浮腫について正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">早期なら血糖コントロールで治る可能性がある</div>
                    <div class="option" data-answer="false">一度発症したら治療法はない</div>
                    <div class="option" data-answer="false">視力には影響しない</div>
                    <div class="option" data-answer="false">網膜の周辺部にのみ影響する</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>糖尿病黄斑浮腫は、早期であれば血糖をコントロールすることで血管からの漏出が減って治る可能性があります。黄斑に水ぶくれが生じると、物がかすんだり歪んで見えたりして視力が低下します。
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>「まだ見えているから大丈夫」と思っている患者様には、早期治療で視力が回復・維持できる可能性があることを伝えましょう。
                    </div>
                </div>
            </div>

            <!-- ========== 問題4 ========== -->
            <div class="question-card hidden" id="question4">
                <div class="question-number">問題 4</div>
                <div class="question-text">新生血管ができる原因となる物質は何ですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">VEGF（血管内皮増殖因子）</div>
                    <div class="option" data-answer="false">インスリン</div>
                    <div class="option" data-answer="false">ヘモグロビン</div>
                    <div class="option" data-answer="false">コレステロール</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>網膜の血管が閉塞すると、酸素を供給しようとしてVEGF（血管内皮増殖因子）という物質が放出され、新生血管が作られます。しかし新生血管は正常な血管と異なり、出血しやすく視力低下につながります。
                </div>
            </div>

            <!-- ========== 問題5 ========== -->
            <div class="question-card hidden" id="question5">
                <div class="question-number">問題 5</div>
                <div class="question-text">糖尿病網膜症と血糖管理について正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">高血糖も重症低血糖も網膜症を進行させる</div>
                    <div class="option" data-answer="false">低血糖は網膜症に影響しない</div>
                    <div class="option" data-answer="false">血糖値は低ければ低いほど網膜症に良い</div>
                    <div class="option" data-answer="false">高血糖のみが網膜症のリスク因子である</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>高血糖が続くことが糖尿病網膜症の原因ですが、経過中に他人の介助を必要とするような重症の低血糖症は、糖尿病網膜症を急激に進行させます。血糖の乱れ（高血糖・低血糖の両方）が網膜症のリスク因子です。
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>患者様には「血糖は高すぎても低すぎてもダメ」ということを伝え、急激な血糖変動を避ける重要性を説明しましょう。
                    </div>
                </div>
            </div>

            <!-- ========== 問題6 ========== -->
            <div class="question-card hidden" id="question6">
                <div class="question-number">問題 6</div>
                <div class="question-text">血管新生緑内障について正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">眼圧が50mmHgを超えることもあり、通常の点眼薬では下がらない</div>
                    <div class="option" data-answer="false">通常の緑内障と同じ治療で対応できる</div>
                    <div class="option" data-answer="false">眼圧は正常範囲内に保たれる</div>
                    <div class="option" data-answer="false">自然に治癒することが多い</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>血管新生緑内障は、新生血管が房水の排水口（線維柱帯）を塞ぐことで異常に眼圧が上昇します。通常21mmHg以下が正常のところ、50mmHgを超えることもあり、通常の点眼薬や飲み薬では眼圧が下がりません。
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>糖尿病網膜症が進行すると緑内障も合併しうることを説明し、定期検査の重要性を伝えましょう。
                    </div>
                </div>
            </div>

            <!-- ========== 問題7 ========== -->
            <div class="question-card hidden" id="question7">
                <div class="question-number">問題 7</div>
                <div class="question-text">汎網膜光凝固（レーザー治療）の目的として正しいものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">酸素不足の網膜神経細胞を凝固してVEGF産生を止める</div>
                    <div class="option" data-answer="false">白内障を治療する</div>
                    <div class="option" data-answer="false">眼圧を下げる</div>
                    <div class="option" data-answer="false">角膜の透明性を回復させる</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>汎網膜光凝固は、酸素を受け取れなくなった網膜の神経細胞をレーザーで凝固して間引くことで、VEGF産生を止める治療です。この治療が糖尿病網膜症を失明原因の首位から3位まで下げることができた主な原因です。
                </div>
            </div>

            <!-- ========== 問題8 ========== -->
            <div class="question-card hidden" id="question8">
                <div class="question-number">問題 8</div>
                <div class="question-text">糖尿病網膜症を進行させる全身因子として、適切<strong>「でない」</strong>ものはどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">高尿酸血症</div>
                    <div class="option" data-answer="false">高血圧</div>
                    <div class="option" data-answer="false">腎機能低下</div>
                    <div class="option" data-answer="false">妊娠</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>糖尿病網膜症を進行させる全身因子として、血糖の乱れ（高血糖・低血糖）、高血圧、腎機能低下、妊娠、喫煙などが挙げられます。高尿酸血症は直接的な進行因子としては挙げられていません。
                </div>
            </div>

            <!-- ========== 問題9 ========== -->
            <div class="question-card hidden" id="question9">
                <div class="question-number">問題 9</div>
                <div class="question-text">糖尿病網膜症の発症・進展を予防できるとされるHbA1cの目標値はどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">7.0％未満</div>
                    <div class="option" data-answer="false">8.0％未満</div>
                    <div class="option" data-answer="false">6.0％未満</div>
                    <div class="option" data-answer="false">9.0％未満</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>血中ヘモグロビン（Hb）A1cが7.0％未満を維持すれば、糖尿病網膜症の発症・進展が予防できることが示唆されています。内科受診時に自分のHbA1c値を記憶する習慣を身につけることが大切です。
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>患者様には「HbA1cの値を覚えておいてください」とお伝えし、内科との連携の重要性を説明しましょう。
                    </div>
                </div>
            </div>

            <!-- ========== 問題10 ========== -->
            <div class="question-card hidden" id="question10">
                <div class="question-number">問題 10</div>
                <div class="question-text">患者様から「糖尿病と言われたけど目は見えているから眼科は必要ない」と言われた場合、最も適切な説明はどれですか？</div>
                <div class="options">
                    <div class="option" data-answer="true">自覚症状がないうちに進行し、症状が出た時には失明の危機のことが多いので早期受診が必要</div>
                    <div class="option" data-answer="false">見えているなら眼科受診は不要なので、視力が下がってから来てもらえばよい</div>
                    <div class="option" data-answer="false">糖尿病の薬を飲んでいれば網膜症にはならないので心配ない</div>
                    <div class="option" data-answer="false">若い人は網膜症にならないので高齢になってから受診すればよい</div>
                </div>
                <div class="feedback"></div>
                <div class="explanation hidden">
                    <strong>解説：</strong>糖尿病網膜症の困った特徴は、症状が自覚されないうちに進行し、自覚症状が現れたときには既に失明の危機に瀕した状態であることがほとんどです。糖尿病と診断されたら、血管閉塞が生じる前に早期に眼科を受診することが大切です。
                    <div class="explanation-image">
                        <img src="../images/explanation/眼底/正常な眼底写真.png" alt="正常な眼底写真">
                        <span class="image-caption">正常な眼底写真：自覚症状がないうちはこのように見える</span>
                    </div>
                    <div class="explanation-image">
                        <img src="../images/explanation/眼底/糖尿病網膜症の眼底写真.png" alt="糖尿病網膜症の眼底写真">
                        <span class="image-caption">糖尿病網膜症の眼底写真：自覚症状が出た時には既にここまで進行していることが多い</span>
                    </div>
                    <div class="staff-point">
                        <strong>患者様への説明ポイント：</strong>「見えているから大丈夫」は危険なサインです。運転免許証や仕事を失わないためにも、無症状のうちから定期検査を受ける重要性を強調しましょう。
                    </div>
                </div>
            </div>

            <div class="buttons">
                <button class="next-button hidden" onclick="nextQuestion()">次の問題へ</button>
                <button class="result-button hidden" onclick="showFinalScore()">🎊 結果発表へ 🎊</button>
            </div>
        </div>
    </div>

    <script src="quiz-config.js"></script>
    <script>
        // クイズ固有の設定
        const QUIZ_ID = 'diabetic_retinopathy';
        const TOTAL_QUESTIONS = 10;
    </script>
    <script src="quiz-core.js"></script>

    <div id="finalResult" class="final-score-card hidden">
      <div id="resultDetail" class="result-detail"></div>
      <div id="badgeAchievement"></div>
      <div class="result-buttons">
        <div class="result-buttons-row">
          <button id="shuffleButton" class="shuffle-button hidden" onclick="goToRandomQuiz()">
            🎲 別のクイズへ
            <span class="btn-sub">ランダム選択</span>
          </button>
          <button id="retryButton" class="retry-button hidden" onclick="restartThisQuiz()">
            🔄 もう一度
            <span class="btn-sub">同じクイズ</span>
          </button>
        </div>
        <div class="result-buttons-row" style="margin-bottom: 12px;">
          <button id="reviewIncorrectButton" class="review-incorrect-button hidden" onclick="reviewIncorrectQuestions()">
            ❌ 間違えた問題を復習
            <span class="btn-sub">苦手を克服</span>
          </button>
        </div>
        <div class="result-buttons-row secondary">
          <a href="../mypage.html" class="record-button hidden">📊 学習記録</a>
          <a href="../index.html" class="home-button-small hidden">🏠 ホーム</a>
        </div>
      </div>
    </div>

</body>
</html>
